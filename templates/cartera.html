{% extends "base.html" %}

{% block titulo %}Cartera{% endblock %}

{% block extra_css %}
<style>
/* === Contenedor principal (horizontal en desktop, vertical en móvil) === */
.wallet-container {
    display: flex;
    /* Permite que los elementos se envuelvan si no hay espacio suficiente */
    flex-wrap: wrap; 
    /* Centra los elementos horizontalmente cuando se envuelven */
    justify-content: center; 
    /* Alinea los elementos al inicio verticalmente */
    align-items: flex-start; 
    gap: 40px; /* Espacio entre la tarjeta y el formulario */
    padding: 40px 20px;
    width: 100%;
    box-sizing: border-box;
}

/* === Tarjeta de crédito (grande, destacada) === */
.creditcard {
    /* Permite que la tarjeta crezca y ocupe más espacio */
    flex: 2 1 450px; /* flex-grow: 2, flex-shrink: 1, base: 450px */
    max-width: 700px; /* Aumenta el tamaño máximo de la tarjeta */
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'Raleway', sans-serif;
    min-width: 300px;
}

.creditcard .front svg {
    width: 100%;
    height: auto;
    aspect-ratio: 750 / 471;
    border-radius: 20px;
    background: linear-gradient(135deg, #000000, #1a1a1a);
    box-shadow: 0 15px 60px rgba(0, 0, 0, 0.6);
}

/* Texto SVG */
svg text {
    font-family: 'Source Code Pro', monospace;
}

/* === Formulario elegante (más pequeño) === */
.recharge-panel {
    /* Permite que el formulario se encoja y su tamaño base sea más pequeño */
    flex: 1 1 300px; /* flex-grow: 1, flex-shrink: 1, base: 300px */
    max-width: 380px; /* Ajusta el ancho máximo del formulario */
    background: #ffffff;
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    font-family: 'Raleway', sans-serif;
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.recharge-panel h3 {
    margin: 0;
    font-size: 20px;
    text-align: center;
    color: #222;
}

.recharge-panel label {
    font-size: 14px;
    color: #555;
    margin-bottom: 5px;
}

.recharge-panel input[type="number"] {
    padding: 10px 12px;
    font-size: 15px;
    border: 1px solid #ccc;
    border-radius: 8px;
    outline: none;
    transition: border-color 0.2s ease;
}

.recharge-panel input[type="number"]:focus {
    border-color: #0070ba;
}

/* === Botones modernos === */
.button-row {
    display: flex;
    justify-content: space-between;
    gap: 10px;
}

/* Asegura que los formularios dentro de button-row sean flex items */
.button-row form {
    flex: 1; /* Permite que los formularios ocupen el espacio disponible */
    display: flex; /* Convierte los formularios en contenedores flex */
}

.button-row button {
    flex: 1; /* Permite que los botones ocupen todo el ancho de su formulario */
    padding: 10px 16px;
    font-size: 15px;
    font-weight: 600;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: transform 0.2s ease, background-color 0.2s ease;
}

.button-row button:hover {
    transform: translateY(-2px);
}

.btn-wompi {
    background-color: #000;
}

.btn-wompi:hover {
    background-color: #000;
}

.btn-paypal {
    background-color: #1f1d1d;
}

.btn-paypal:hover {
    background-color: #1f1d1d;
}

/* === Responsive para pantallas pequeñas === */
@media (max-width: 768px) {
    .wallet-container {
        flex-direction: column;
        align-items: center;
    }

    .button-row {
        flex-direction: column;
    }

    .button-row button {
        width: 100%;
    }
}
</style>

{% endblock %}

{% block contenido %}

<div class="wallet-container">

    <!-- Tarjeta -->
    <div class="creditcard">
        <div class="front">
            <svg version="1.1" id="cardfront" xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 750 471">
                <g id="Front">
                    <path fill="#000" d="M40,0h670c22.1,0,40,17.9,40,40v391c0,22.1-17.9,40-40,40H40c-22.1,0-40-17.9-40-40V40C0,17.9,17.9,0,40,0z"/>
                    <!-- Líneas -->
                    <line x1="1200" y1="50" x2="600" y2="50" stroke="#fff" stroke-width="1.5"/>
                    <line x1="1100" y1="100" x2="550" y2="100" stroke="#fff" stroke-width="1.5"/>
                    <line x1="1150" y1="150" x2="580" y2="150" stroke="#fff" stroke-width="1.5"/>
                    <line x1="1250" y1="200" x2="430" y2="200" stroke="#fff" stroke-width="1.5"/>
                    <line x1="1300" y1="250" x2="620" y2="250" stroke="#fff" stroke-width="1.5"/>
                    <line x1="1400" y1="300" x2="610" y2="300" stroke="#fff" stroke-width="1.5"/>
                    <line x1="1350" y1="350" x2="600" y2="350" stroke="#fff" stroke-width="1.5"/>
                    <line x1="1250" y1="400" x2="590" y2="400" stroke="#fff" stroke-width="1.5"/>

                    <!-- Nodos -->
                    <circle cx="600" cy="50" r="3" fill="#fff"/>
                    <circle cx="550" cy="100" r="3" fill="#fff"/>
                    <circle cx="580" cy="150" r="3" fill="#fff"/>
                    <circle cx="430" cy="200" r="3" fill="#fff"/>
                    <circle cx="620" cy="250" r="3" fill="#fff"/>
                    <circle cx="610" cy="300" r="3" fill="#fff"/>
                    <circle cx="600" cy="350" r="3" fill="#fff"/>
                    <circle cx="590" cy="400" r="3" fill="#fff"/>

                    <!-- Branding -->
                    <text x="60" y="100" font-size="36" fill="#fff" font-weight="bold">ORYON</text>
                    <text x="60" y="280" font-size="28" fill="#fff">Saldo:</text>
                    <text x="60" y="310" font-size="36" font-weight="bold" fill="#fff">${{ saldo }} COP</text>
                    <text x="60" y="370" font-size="24" fill="#fff">**** **** **** 1122</text>
                    <text x="60" y="410" font-size="18" fill="#fff">
                        {{ session['usuario']|default("Usuario")|upper }}
                    </text>
                </g>
            </svg>
        </div>
    </div>

    <!-- Panel de recarga -->
    <div class="recharge-panel">
        <h3>Recargar saldo</h3>
        <label for="monto" class="form-label">Monto a recargar</label>
        <input type="number" min="1000" name="monto" id="monto" class="form-control" placeholder="Ej. 10000" required>

        <div class="button-row">
            <!-- Wompi -->
            <form action="{{ url_for('iniciar_wompi') }}" method="POST">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <input type="hidden" name="monto" id="wompi_monto">
                <button type="submit" class="btn-wompi">Wompi</button>
            </form>

            <!-- PayPal -->
            <form action="{{ url_for('iniciar_paypal') }}" method="POST">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <input type="hidden" name="monto" id="paypal_monto">
                <button type="submit" class="btn-paypal">PayPal</button>
            </form>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
// Actualizar los campos ocultos con el monto
document.getElementById('monto').addEventListener('input', function () {
    const value = this.value;
    document.getElementById('wompi_monto').value = value;
    document.getElementById('paypal_monto').value = value;
});
</script>
{% endblock %}
